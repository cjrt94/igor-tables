<template>
  <div class="h-[100vh] w-[100vw] flex items-center justify-center absolute top-0 left-0 z-10 bg-white"
       :class="{'hidden': isValid}">
    <div class="bg-gray-100 rounded-lg p-8 w-[300px]">
      <svg class="mb-4 mx-auto" xmlns="http://www.w3.org/2000/svg" width="140.501" height="55.861"
           viewBox="0 0 140.501 55.861">
        <g id="Group_61" data-name="Group 61" transform="translate(-71.277 -149.976)">
          <path id="Path_1" data-name="Path 1"
                d="M248.067,234.61c2.644,0,11.272-.622,11.272-8.625,0-2.368-1.291-4.275-3.835-5.668l-.645-.352.6-.42a8.068,8.068,0,0,0,3.592-6.393v-.023a7.454,7.454,0,0,0-1.809-5.175l-.244-.293,2.533-3.007-4.763-3.362c-.419.575-.885,1.159-1.339,1.728-.206.259-.411.516-.609.77l-.2.255-.306-.105a12.69,12.69,0,0,0-4.169-.79c-6.492,0-11.027,4.1-11.027,9.969,0,5.957,4.328,9.806,11.027,9.806,3.655,0,4.2,1.918,4.2,3.061,0,2.049-1.721,3.427-4.282,3.427a4.478,4.478,0,0,1-3.333-1.133,4.056,4.056,0,0,1-1.028-2.775h-6.321a8.3,8.3,0,0,0,2.079,6.1c1.845,1.97,4.819,3.011,8.6,3.011m.081-17.087a4.279,4.279,0,0,1-4.444-4.4c0-2.829,1.786-4.73,4.444-4.73a4.527,4.527,0,0,1,4.4,4.73,4.175,4.175,0,0,1-4.4,4.4"
                transform="translate(-92.988 -28.773)" fill="#1d1d1b"/>
          <path id="Path_2" data-name="Path 2"
                d="M305.615,206.355c-5.331,0-11.027,2.651-11.027,10.091,0,7.418,5.94,10.05,11.027,10.05,5.489,0,11.027-3.107,11.027-10.05,0-7.448-5.94-10.091-11.027-10.091m0,14.9a4.837,4.837,0,1,1,4.607-4.811,4.569,4.569,0,0,1-4.607,4.811"
                transform="translate(-125.21 -31.612)" fill="#1d1d1b"/>
          <path id="Path_3" data-name="Path 3"
                d="M217.711,185.78c-1.86,0-3.861,1.068-3.861,3.413,0,2.317,2,3.373,3.861,3.373a3.406,3.406,0,1,0,0-6.786"
                transform="translate(-79.94 -20.075)" fill="#1d1d1b"/>
          <rect id="Rectangle_20" data-name="Rectangle 20" width="6.664" height="19.286"
                transform="translate(134.358 175.11)" fill="#1d1d1b"/>
          <path id="Path_4" data-name="Path 4"
                d="M363.987,212.061a6.352,6.352,0,0,1,3.3.883l2.547-4.988a6.646,6.646,0,0,0-4.741-1.784,5.666,5.666,0,0,0-4.839,2.493l-.581.833-.68-2.878H353.17V225.9h6.582v-9.317c0-2.918,1.464-4.484,4.234-4.526"
                transform="translate(-158.057 -31.508)" fill="#1d1d1b"/>
          <path id="Path_5" data-name="Path 5"
                d="M109.133,220.847a1.574,1.574,0,0,0-2.877.243l-.409,1.21a20.663,20.663,0,0,0,4.976,1.686Z"
                transform="translate(-19.383 -39.273)" fill="#cccbcb"/>
          <path id="Path_6" data-name="Path 6"
                d="M145.025,221.089a1.574,1.574,0,0,0-2.876-.242l-1.7,3.148a20.711,20.711,0,0,0,4.987-1.679Z"
                transform="translate(-38.787 -39.273)" fill="#cccbcb"/>
          <path id="Path_7" data-name="Path 7"
                d="M119.306,216.192c-3.583-5.392-6.163-5.6-6.673-5.613-.616,2.6-2.821,4.882-5.981,6.445a20.7,20.7,0,0,1-4.987,1.678,25.766,25.766,0,0,1-10.226-.009,20.665,20.665,0,0,1-4.976-1.686c-3.141-1.561-5.333-3.834-5.946-6.426-.5.043-3.083.208-6.673,5.611-4.009,6.038-2.586,7.416-.69,8.28s5.693.635,5.219-3.635c-.191-2.136.118-4.978,1.6-6.351-.627,6.108.7,7.938,1.353,8.7.776.906,2.363.582,3.43-.42s.969-.454,2.327,2.586,3.688,5.29,5.159,2.4,3.429-2.372,3.429-2.372h1.767s1.956-.522,3.429,2.372,3.8.645,5.157-2.4,1.263-3.59,2.33-2.586,2.651,1.326,3.427.42c.653-.761,1.988-2.6,1.35-8.736,1.521,1.358,1.84,4.235,1.647,6.391-.475,4.27,3.321,4.5,5.216,3.635s3.322-2.242-.688-8.28"
                transform="translate(0 -33.98)" fill="#27bcee"/>
          <path id="Path_8" data-name="Path 8"
                d="M124.419,172.721c-.166-6.72-1.978-22.745-15.507-22.745h-.738c-7.147.036-11.009,4.559-13.082,9.8a39.45,39.45,0,0,0-2.347,12.954c-.043,1.722.023,2.832.028,2.9a0,0,0,0,0,0,0c4.744,4.225,15.479,4.064,15.479,4.064h.658s10.737.16,15.479-4.064c0,0,.073-1.127.028-2.912m-20.978-6.912a2.934,2.934,0,0,1,3.036-.082c.461.322-.067.9-.067.9a1.9,1.9,0,0,0-1.46-.529,1.884,1.884,0,0,0-1.44.659v0s-.478-.6-.068-.943m2.453,5.5a1.258,1.258,0,1,0-1.522.125,2.151,2.151,0,1,1,1.522-.125m4.766-5.586a2.934,2.934,0,0,1,3.036.082c.41.341-.068.943-.068.943v0a1.884,1.884,0,0,0-1.44-.659,1.9,1.9,0,0,0-1.46.529s-.528-.578-.067-.9m2.108,5.71a1.264,1.264,0,1,0-1.52-.121,2.148,2.148,0,1,1,1.52.121"
                transform="translate(-12.029 0)" fill="#27bcee"/>
        </g>
      </svg>
      <div class="text-center mb-4">
        <span class="block mb-2">Ingresa el c√≥digo</span>
        <input v-model.number="code" type="number" max="4" class="h-[45px] rounded-full text-center w-full text-xl tracking-widest">
      </div>
      <button
        :disabled="loading"
        @click="validate"
        class="bg-primary text-white w-full rounded-full h-14 font-body active:scale-95 ease-linear duration-300 flex items-center justify-center"
        type="submit" id="form-checkout__submit">
        <!--Loading-->
        <svg v-if="loading" class="animate-spin -ml-1 mr-3 h-4 w-5 fill-primary"
             xmlns="http://www.w3.org/2000/svg"
             fill="none"
             viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor"
                d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
        </svg>
        <!--End-->
        <span>Validar</span>
      </button>
    </div>
  </div>
</template>

<script>
export default {
  name: 'Validate',
  data () {
    return {
      code: '',
      loading: false,
      isValid: true
    }
  },
  methods: {
    /**
     * Validate restaurant code
     */
    async validate () {
      try {
        if (this.code) {
          this.loading = true
          const response = await this.$axios.$post('https://southamerica-east1-igor-f5349.cloudfunctions.net/front-validateCode', {
            code: this.code
          })
          this.isValid = response.isValid
          this.$emit('codeIsValid')
        }
      } catch (e) {
        console.log(e)
        this.$toast.error('Error al validar', { duration: 3000 })
      } finally {
        this.loading = false
      }
    }
  }
}
</script>
